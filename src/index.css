/* ---------- Tailwind setup ---------- */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* ---------- Custom utilities ---------- */
@layer utilities {
  /* ====== Soft dots background (used on <main>) ====== */
  .bg-dots-light {
    /* keep your pastel/light page color from JS tokens; this overlays dots */
    background-image: radial-gradient(rgba(20, 20, 20, 0.12) 1px, transparent 1px);
    background-size: 22px 22px;
    background-position: 0 0;
  }
  .bg-dots-dark {
    background-image: radial-gradient(rgba(255, 255, 255, 0.08) 1px, transparent 1px);
    background-size: 22px 22px;
    background-position: 0 0;
  }

  /* ====== Tiny base animation helpers ====== */
  .cin-fade-in { animation: cinFade 700ms ease-out forwards; }
  .cin-fade-in-delayed { animation: cinFade 800ms ease-out 180ms forwards; }
  .cin-slide-up { animation: cinSlideUp 700ms ease-out forwards; }
  .cin-slide-up-delay { animation: cinSlideUp 700ms ease-out 140ms forwards; }
  .cin-zoom-in { animation: cinZoom 1000ms ease-out forwards; }
  .cin-vignette {
    background: radial-gradient(ellipse at center, rgba(0,0,0,0) 55%, rgba(0,0,0,0.35) 100%);
  }

  @keyframes cinFade {
    from { opacity: 0; }
    to   { opacity: 1; }
  }
  @keyframes cinSlideUp {
    from { opacity: 0; transform: translateY(8px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  @keyframes cinZoom {
    from { transform: scale(1.035); opacity: 0; }
    50%  { opacity: 1; }
    to   { transform: scale(1); opacity: 1; }
  }

  /* ====== Caret blink (typing) ====== */
  .cin-caret {
    height: 1em;
    background: currentColor;
    animation: cin-caret-blink 0.8s steps(1, end) infinite;
  }
  @keyframes cin-caret-blink {
    50% { opacity: 0; }
  }

  /* ====== Vanish with tiny scale-in ====== */
  .cin-fade-out-scale { animation: cin-fade-out-scale-kf 0.42s ease forwards; }
  @keyframes cin-fade-out-scale-kf {
    0%   { opacity: 1; transform: scale(1); }
    100% { opacity: 0; transform: scale(0.92); }
  }

  /* ====== Brand quick double pulse ====== */
  .cin-pulse-zoom-twice {
    animation:
      cin-pulse-zoom-kf 240ms ease-in-out 0ms 1,
      cin-pulse-zoom-kf 240ms ease-in-out 320ms 1;
  }
  @keyframes cin-pulse-zoom-kf {
    0%   { transform: scale(1); }
    50%  { transform: scale(1.035); filter: blur(0.2px); }
    100% { transform: scale(1); filter: blur(0); }
  }

  /* ====== Image radial reveal from center (mask) ====== */
  .cin-radial-reveal {
    -webkit-mask-image: radial-gradient(circle at 50% 50%, rgba(0,0,0,1) 0%, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 0%);
            mask-image: radial-gradient(circle at 50% 50%, rgba(0,0,0,1) 0%, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 0%);
    animation: cin-reveal-mask 900ms ease-out forwards;
  }
  @keyframes cin-reveal-mask {
    0% {
      -webkit-mask-image: radial-gradient(circle at 50% 50%, rgba(0,0,0,1) 0%, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 0%);
              mask-image: radial-gradient(circle at 50% 50%, rgba(0,0,0,1) 0%, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 0%);
    }
    100% {
      -webkit-mask-image: none;
              mask-image: none;
    }
  }

  /* ====== Image subtle movement into place ====== */
  .cin-image-move-in { animation: cin-img-move-in-kf 900ms ease-out forwards; }
  @keyframes cin-img-move-in-kf {
    0%   { transform: translateY(10px) scale(1.01); opacity: 0.85; }
    100% { transform: translateY(0) scale(1);      opacity: 1; }
  }

  /* ====== Overshoot-in (hit from right) for titles ====== */
  .cin-overshoot-in { animation: cin-overshoot-kf 620ms cubic-bezier(.2,.7,.2,1) forwards; }
  @keyframes cin-overshoot-kf {
    0%   { opacity: 0; transform: translateX(64px); }
    60%  { opacity: 1; transform: translateX(-10px); } /* hit/overshoot */
    100% { opacity: 1; transform: translateX(0); }
  }

  /* ====== Delays for staged lines ====== */
  .delay-\[220ms\]  { animation-delay: 220ms !important; }
  .delay-\[500ms\]  { animation-delay: 500ms !important; }
  .delay-\[750ms\]  { animation-delay: 750ms !important; }
  .delay-\[1150ms\] { animation-delay: 1150ms !important; }

  /* ====== Explode Out (scatter letters) ====== */
  @keyframes explodeOut {
    to {
      opacity: 0;
      transform:
        translate(calc(var(--dx, 0) * 1px), calc(var(--dy, 0) * 1px))
        rotate(calc(var(--rot, 0) * 1deg))
        scale(0.85);
      filter: blur(0.8px);
    }
  }
  .explode-out {
    display: inline-block;
    will-change: transform, opacity, filter;
    animation: explodeOut 900ms ease forwards;
  }

  /* ====== Random Entry (jitter in) ====== */
  @keyframes randomIn {
    from {
      opacity: 0;
      transform:
        translate(calc(var(--dx, 0) * 1px), calc(var(--dy, 0) * 1px))
        rotate(calc(var(--rot, 0) * 1deg))
        scale(1.5);
      filter: blur(1px);
    }
    to {
      opacity: 1;
      transform: none;
      filter: blur(0);
    }
  }
  .random-in {
    display: inline-block;
    will-change: transform, opacity, filter;
    animation: randomIn 850ms ease-out forwards;
  }

  /* ====== Ripple + Flash (global click + title hit) ====== */
  @keyframes rippleFlash {
    0%   { transform: scale(0); opacity: 0.95; box-shadow: 0 0 15px rgba(255,255,255,0.9); }
    40%  { opacity: 0.75; box-shadow: 0 0 28px rgba(255,255,255,1); }
    100% { transform: scale(5); opacity: 0; box-shadow: 0 0 0 rgba(255,255,255,0); }
  }
  .ripple-flash {
    position: absolute;
    border-radius: 9999px;
    background: radial-gradient(circle, #ffffff 0%, rgba(255,255,255,0.25) 55%, rgba(255,255,255,0) 70%);
    width: 56px;
    height: 56px;
    pointer-events: none;
    mix-blend-mode: screen;
    animation: rippleFlash 900ms ease-out forwards;
  }

  /* (Legacy) center ripple if you trigger without coords */
  .cin-ripple-layer { pointer-events: none; }
  .cin-ripple { animation: cin-ripple-kf 650ms ease-out 1; }
  @keyframes cin-ripple-kf {
    0%   { box-shadow: 0 0 0 0 rgba(255,255,255,0.18), inset 0 0 0 0 rgba(255,255,255,0.12); }
    60%  { box-shadow: 0 0 0 18px rgba(255,255,255,0), inset 0 0 0 10px rgba(255,255,255,0); }
    100% { box-shadow: 0 0 0 22px rgba(255,255,255,0), inset 0 0 0 12px rgba(255,255,255,0); }
  }

  /* ====== Reduced motion: keep things accessible ====== */
  @media (prefers-reduced-motion: reduce) {
    .cin-fade-in,
    .cin-fade-in-delayed,
    .cin-slide-up,
    .cin-slide-up-delay,
    .cin-zoom-in,
    .cin-radial-reveal,
    .cin-image-move-in,
    .cin-overshoot-in,
    .explode-out,
    .random-in {
      animation: none !important;
      transition: none !important;
    }
  }
}

/* Micro-parallax helper */
.parallax-img {
  will-change: transform;
  transition: transform 120ms ease-out;
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .parallax-img { transition: none !important; transform: none !important; }
}

/* optional: hide horizontal scrollbar on the carousel track */
.snap-x::-webkit-scrollbar { display: none; }


/* ===================== ONE PIECE UTILITIES (add to global CSS) =====================
Add this once to your global CSS (e.g., index.css) under @layer utilities:


@layer utilities {
.bg-grand-line {
background-image:
radial-gradient(rgba(255,255,255,0.06) 1px, transparent 1px), /* map dots */
linear-gradient(180deg, #004b8d 0%, #0077b6 50%, #00b4d8 100%); /* sea */
background-size: 22px 22px, 100% 100%;
background-position: 0 0, center;
}
.texture-parchment {
background: radial-gradient(1200px 600px at 10% 10%, rgba(0,0,0,.06), transparent 40%),
radial-gradient(1000px 800px at 90% 20%, rgba(0,0,0,.05), transparent 45%),
radial-gradient(800px 500px at 30% 90%, rgba(0,0,0,.05), transparent 40%),
linear-gradient(#f6edd2, #eadbb6);
}
.rope-divider { position: relative; }
.rope-divider:after {
content: ""; position: absolute; inset-inline: 0; bottom: -2px; height: 8px;
background-image: repeating-linear-gradient(45deg,#c8a96e 0 6px,#a77f3e 6px 12px);
border-radius: 9999px; filter: drop-shadow(0 2px 0 rgba(0,0,0,.25));
}
.wanted-edge { border: 2px solid #3a2b13; border-radius: 8px; box-shadow: inset 0 0 0 2px rgba(255,255,255,.35), 0 10px 18px rgba(0,0,0,.25); }
.stamp-berry { position: absolute; inset: auto 8px 8px auto; rotate: -12deg; border: 2px solid #7c0000; color: #7c0000; padding: 2px 10px; font-weight: 800; letter-spacing: .08em; text-transform: uppercase; background: rgba(174,0,0,.08); }
.tilt { transform-style: preserve-3d; transition: transform .3s ease; }
.tilt:hover { transform: rotate3d(1,1,0,6deg) translateY(-2px); }
}
*/
/* ===================== One Piece Intro Utilities ===================== */

/* Caret blink for typewriter */
.cin-caret {
  height: 0.9em;
  border-right: 2px solid currentColor;
  animation: cin-caret-blink 0.9s steps(1) infinite;
}
@keyframes cin-caret-blink { 50% { border-color: transparent; } }

/* Explode-out (letters pop/vanish) */
.cin-explode-out {
  animation: cin-explode 520ms ease forwards;
}
@keyframes cin-explode {
  0%   { transform: scale(1);   opacity: 1;   filter: blur(0px); }
  60%  { transform: scale(1.06);opacity: 0.6; filter: blur(1px); }
  100% { transform: scale(0.95);opacity: 0;   filter: blur(2px); }
}

/* Radial mask reveal over the left image */
.cin-radial-reveal {
  -webkit-mask-image: radial-gradient(circle at 50% 50%, #000 0%, transparent 0%);
  mask-image: radial-gradient(circle at 50% 50%, #000 0%, transparent 0%);
  animation: cin-reveal 1100ms ease forwards;
}
@keyframes cin-reveal {
  0%   { -webkit-mask-size: 0% 0%;    mask-size: 0% 0%; }
  100% { -webkit-mask-size: 250% 250%;mask-size: 250% 250%; }
}

/* Image gentle move-in */
.cin-image-move-in {
  transform: translateY(8px) scale(0.98);
  opacity: 0.6;
  animation: cin-image-in 650ms ease-out forwards;
}
@keyframes cin-image-in {
  to { transform: translateY(0) scale(1); opacity: 1; }
}

/* Overshoot-in titles */
.cin-overshoot-in {
  transform: translateY(8px) scale(0.98);
  opacity: 0;
  animation: cin-overshoot 600ms cubic-bezier(.2,1.2,.2,1) forwards;
}
.cin-overshoot-in.delay-\[480ms\] { animation-delay: 480ms; }
.cin-overshoot-in.delay-\[850ms\] { animation-delay: 850ms; }
@keyframes cin-overshoot {
  0%   { transform: translateY(8px) scale(0.98); opacity: 0; }
  60%  { transform: translateY(-2px) scale(1.02); opacity: 1; }
  100% { transform: translateY(0) scale(1); opacity: 1; }
}

/* Subtle delayed fade (Enter button) */
.cin-fade-in-delayed {
  opacity: 0;
  animation: cin-fadein 700ms ease forwards;
  animation-delay: 900ms;
}
@keyframes cin-fadein { to { opacity: 1; } }

/* Ripple & flash marks for click/impact */
.cin-ripple-layer { position: absolute; inset: 0; overflow: hidden; pointer-events: none; }
.cin-ripple {
  position: absolute;
  width: 2px; height: 2px;
  margin-left: -1px; margin-top: -1px;
  background: rgba(255,255,255,.45);
  border-radius: 9999px;
  box-shadow: 0 0 14px rgba(255,255,255,.5);
  animation: cin-ripple-expand 800ms ease-out forwards;
}
.cin-ripple.circle::after {
  content: "";
  position: absolute; inset: -6px;
  border: 2px solid rgba(255,255,255,.35);
  border-radius: inherit;
}
@keyframes cin-ripple-expand {
  0%   { transform: scale(1);   opacity: 0.9; }
  100% { transform: scale(160); opacity: 0;   }
}
.cin-flash {
  position: absolute;
  width: 40px; height: 40px;
  margin-left: -20px; margin-top: -20px;
  background: radial-gradient(circle, rgba(255,255,255,.8) 0%, rgba(255,255,255,0) 60%);
  filter: blur(1px);
  animation: cin-flash-out 360ms ease-out forwards;
}
@keyframes cin-flash-out {
  from { opacity: 1; transform: scale(0.8); }
  to   { opacity: 0; transform: scale(1.4); }
}

/* Optional dotted map/ocean BG helper if you want to reuse outside intro */
.bg-grand-line {
  background-image:
    radial-gradient(rgba(255,255,255,0.06) 1px, transparent 1px),
    linear-gradient(180deg, #001f3f 0%, #005a8d 50%, #00a2c7 100%);
  background-size: 22px 22px, 100% 100%;
  background-position: 0 0, center;
}

/* Rope divider utility (you can add to headers if you like) */
.rope-divider { position: relative; }
.rope-divider:after {
  content: "";
  position: absolute; left: 0; right: 0; bottom: -2px; height: 8px;
  background-image: repeating-linear-gradient(45deg,#c8a96e 0 6px,#a77f3e 6px 12px);
  border-radius: 9999px; filter: drop-shadow(0 2px 0 rgba(0,0,0,.25));
}
